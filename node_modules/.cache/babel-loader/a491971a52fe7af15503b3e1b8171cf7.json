{"ast":null,"code":"import { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n  return function TimeoutErrorImpl(info) {\n    if (info === void 0) {\n      info = null;\n    }\n    _super(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    this.info = info;\n  };\n});\nexport function timeout(config, schedulerArg) {\n  var _a = isValidDate(config) ? {\n      first: config\n    } : typeof config === 'number' ? {\n      each: config\n    } : config,\n    first = _a.first,\n    each = _a.each,\n    _b = _a.with,\n    _with = _b === void 0 ? timeoutErrorFactory : _b,\n    _c = _a.scheduler,\n    scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c,\n    _d = _a.meta,\n    meta = _d === void 0 ? null : _d;\n  if (first == null && each == null) {\n    throw new TypeError('No timeout provided.');\n  }\n  return operate(function (source, subscriber) {\n    var originalSourceSubscription;\n    var timerSubscription;\n    var lastValue = null;\n    var seen = 0;\n    var startTimer = function (delay) {\n      timerSubscription = executeSchedule(subscriber, scheduler, function () {\n        try {\n          originalSourceSubscription.unsubscribe();\n          innerFrom(_with({\n            meta: meta,\n            lastValue: lastValue,\n            seen: seen\n          })).subscribe(subscriber);\n        } catch (err) {\n          subscriber.error(err);\n        }\n      }, delay);\n    };\n    originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n      timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      seen++;\n      subscriber.next(lastValue = value);\n      each > 0 && startTimer(each);\n    }, undefined, undefined, function () {\n      if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n        timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      }\n      lastValue = null;\n    }));\n    !seen && startTimer(first != null ? typeof first === 'number' ? first : +first - scheduler.now() : each);\n  });\n}\nfunction timeoutErrorFactory(info) {\n  throw new TimeoutError(info);\n}","map":{"version":3,"sources":["../../../../src/internal/operators/timeout.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n    return function TimeoutErrorImpl(info) {\n        if (info === void 0) { info = null; }\n        _super(this);\n        this.message = 'Timeout has occurred';\n        this.name = 'TimeoutError';\n        this.info = info;\n    };\n});\nexport function timeout(config, schedulerArg) {\n    var _a = (isValidDate(config) ? { first: config } : typeof config === 'number' ? { each: config } : config), first = _a.first, each = _a.each, _b = _a.with, _with = _b === void 0 ? timeoutErrorFactory : _b, _c = _a.scheduler, scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c, _d = _a.meta, meta = _d === void 0 ? null : _d;\n    if (first == null && each == null) {\n        throw new TypeError('No timeout provided.');\n    }\n    return operate(function (source, subscriber) {\n        var originalSourceSubscription;\n        var timerSubscription;\n        var lastValue = null;\n        var seen = 0;\n        var startTimer = function (delay) {\n            timerSubscription = executeSchedule(subscriber, scheduler, function () {\n                try {\n                    originalSourceSubscription.unsubscribe();\n                    innerFrom(_with({\n                        meta: meta,\n                        lastValue: lastValue,\n                        seen: seen,\n                    })).subscribe(subscriber);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }, delay);\n        };\n        originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            seen++;\n            subscriber.next((lastValue = value));\n            each > 0 && startTimer(each);\n        }, undefined, undefined, function () {\n            if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n                timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            }\n            lastValue = null;\n        }));\n        !seen && startTimer(first != null ? (typeof first === 'number' ? first : +first - scheduler.now()) : each);\n    });\n}\nfunction timeoutErrorFactory(info) {\n    throw new TimeoutError(info);\n}\n//# sourceMappingURL=timeout.js.map"]},"metadata":{},"sourceType":"module"}